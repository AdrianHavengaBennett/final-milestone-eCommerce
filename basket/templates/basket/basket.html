{% extends 'base.html' %}

{% block content %}

	<nav aria-label="breadcrumb">
		<ol class="breadcrumb">
			<li class="breadcrumb-item"><a href="{% url 'products-home' %}">Home</a></li>
			<li class="breadcrumb-item active" aria-current="page">Basket</li>
		</ol>
	</nav>

{% if basket_items %}
	<h2 class="account-heading text-center">Basket Subtotal: £{{ sub_total }}</h2>
	<div class="form-group">
		<a href="#">
			<button class="btn"><i class="fa fa-credit-card" aria-hidden="true"></i> GO TO CHECKOUT</button>
		</a>
	</div>

	<div class="content-section">
		<div class="row">
			<div class="table-responsive basket-info">
				<table class="table table-sm table-borderless">
					<thead class=text-black>
						<tr>
							<th scope="col">Details:</th>
							<th scope="col"></th>
							<th scope="col">Price:</th>
							<th scope="col">Qty:</th>
							<th scope="col">Total:</th>
						</tr>
					</thead>

					{% for item in basket_items %}
						<tr>
							<td class="p-2 w-25">
								<a href="{% url 'product-detail' item.product.id %}">
									<img class="img-fluid" src="{{ item.product.image.url }}">
								</a>
							</td>
							<td class="py-3">
								<a href="{% url 'product-detail' item.product.id %}">
									<p class="my-0">{{ item.product.name }}</p>
								</a>
							</td>
							<td class="py-3">
								<p class="my-0">£{{ item.product.price }}</p>
							</td>
							<td class="py-3">
								<form class="form update-form" action="{% url 'update-basket' item.item_id %}" method="POST">
									{% csrf_token %}
									<div class="form-group">
										<div class="input-group">
											<div class="input-group-prepend">
												<button class="decrement-qty btn btn-sm" 
												data-item_id="{{ item.item_id }}" id="decrement-qty_{{ item.item_id  }}">
													<span>
														<i class="fa fa-minus fa-sm" aria-hidden="true"></i>
													</span>
												</button>
											</div>
											<input class="form-control form-control-sm qty_input" type="number"
											name="quantity" value="{{ item.quantity }}" min="1" max="99"
											data-item_id="{{ item.item_id }}"
											id="id_qty_{{ item.item_id }}">
											<div class="input-group-append">
												<button class="increment-qty btn btn-sm"
												data-item_id="{{ item.item_id }}" id="increment-qty_{{ item.item_id }}">
													<span>
														<i class="fa fa-plus fa-sm" aria-hidden="true"></i>
													</span>
												</button>
											</div>
										</div>
									</div>
								</form>
								<a class="update-link text-info"><small>Update</small></a>
                                <a class="remove-item text-danger float-right" id="remove_{{ item.item_id }}"><small>Remove</small></a>
							</td>
							<td class="py-3">
								<p class="my-0">£{{ item.product_total }}</p>
							</td>
						</tr>
					{% endfor %}
				</table>

				<hr>

				<h6 id="delivery-heading">Delivery Option: </h6>
				<form action="" method="POST">
					<div class="delivery-option">
						<input type="radio" name="delivery-option" id="delivery" checked>
						<label for="delivery">Delivery*</label>
					</div>
					<div class="delivery-option">
						<input type="radio" name="delivery-option" id="click-and-collect">
						<label for="click-and-collect">Click&Collect**</label>
					</div>
					<div class="dropdown">
						<a class="dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
							Choose Location
						</a>
						<div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
							<a type="submit" id="ben-hardware" class="dropdown-item" href="#">Ben's Hardware</a>
							<a type="submit" id="post-office" class="dropdown-item" href="#">Pembroke Park Post Office</a>
						</div>
					</div>
				</form>
				
				<hr>
				<p>*Please note that we offer a fixed delivery fee of £20 to all mainland postcodes only. 
					Unfortunately, we cannot deliver to any other postcodes at this time. If you're unsure, please contact us 
					<a href="{% url 'contact-us' %}">here.</a>
				</p>
				<p>
					**If you decide to use our free Click&Collect service, please check out the current locations available 
					<a href="{% url 'click_and_collect' %}">here.</a>
				</p>
			</div>
		</div>
	</div>

	<h2 id="basket-total" class="account-heading text-center">Total (incl. VAT & Delivery): £{{ grand_total }}</h2>
	<div class="form-group">
		<a href="#">
			<button class="btn"><i class="fa fa-credit-card" aria-hidden="true"></i> GO TO CHECKOUT</button>
		</a>
		<a href="{% url 'products-home' %}">
			<button class="btn"><i class="fa fa-hand-o-left" aria-hidden="true"></i> KEEP SHOPPING</button>
		</a>
	</div>
{% else %}
	<div class="text-center">
		<h2 class="account-heading">Basket is empty.</h2>
		<p><a href="{% url 'products-home' %}"><i class="fa fa-hand-o-left" aria-hidden="true"></i> Back to all Products</a></p>
	</div>
{% endif %}

{% endblock %}

